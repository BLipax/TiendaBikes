{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useCart}from'../context/CartContext';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Carrito(){const{cart,total,removeFromCart,updateQuantity,clearCart,mensajeProducto}=useCart();const[mensajePago,setMensajePago]=useState('');const[loading,setLoading]=useState(false);useEffect(()=>{if(mensajePago){const timer=setTimeout(()=>setMensajePago(''),5000);return()=>clearTimeout(timer);}},[mensajePago]);const handlePagar=async()=>{setLoading(true);try{const response=await fetch('https://tiendabikes-1.onrender.com/api/productos/iniciar_pago/',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({total:total.toFixed(2)})});const data=await response.json();if(data.url&&data.token){setMensajePago('Redirigiendo a Transbank...');window.location.href=\"\".concat(data.url,\"?token_ws=\").concat(data.token);}else{setMensajePago('Error: no se recibió URL ni token.');}}catch(error){setMensajePago('Error al iniciar el pago.');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',minHeight:'80vh',padding:'20px',maxWidth:'600px',margin:'0 auto',backgroundColor:'#f9f9f9',borderRadius:'8px'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{textAlign:'center'},children:\"Carrito de Compras\"}),mensajeProducto&&/*#__PURE__*/_jsx(\"div\",{style:{color:'green',marginBottom:'10px'},children:mensajeProducto}),mensajePago&&/*#__PURE__*/_jsx(\"div\",{style:{color:mensajePago.includes('Error')?'red':'blue',marginBottom:'10px'},children:mensajePago}),cart.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Tu carrito est\\xE1 vac\\xEDo.\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[cart.map(item=>/*#__PURE__*/_jsxs(\"div\",{style:{borderBottom:'1px solid #ccc',marginBottom:'10px',paddingBottom:'10px',width:'100%'},children:[/*#__PURE__*/_jsx(\"h3\",{children:item.nombre}),/*#__PURE__*/_jsx(\"p\",{children:item.descripcion}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:item.cantidad,onChange:e=>updateQuantity(item.id,e.target.value),min:\"1\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Precio unitario: $\",item.precio]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Subtotal: $\",item.precio*item.cantidad]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFromCart(item.id),children:\"Eliminar\"})]},item.id)),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Total: $\",total.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{onClick:handlePagar,disabled:loading,style:{backgroundColor:'#0070f3',color:'white',padding:'10px 20px',border:'none',borderRadius:'5px',cursor:loading?'not-allowed':'pointer'},children:loading?'Procesando pago...':'Pagar con Transbank'}),/*#__PURE__*/_jsx(\"button\",{onClick:clearCart,style:{marginTop:'10px',backgroundColor:'red',color:'white',padding:'10px 20px',border:'none',borderRadius:'5px',cursor:'pointer'},children:\"Vaciar Carrito\"})]})]});}export default Carrito;","map":{"version":3,"names":["React","useState","useEffect","useCart","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Carrito","cart","total","removeFromCart","updateQuantity","clearCart","mensajeProducto","mensajePago","setMensajePago","loading","setLoading","timer","setTimeout","clearTimeout","handlePagar","response","fetch","method","headers","body","JSON","stringify","toFixed","data","json","url","token","window","location","href","concat","error","style","display","flexDirection","alignItems","justifyContent","minHeight","padding","maxWidth","margin","backgroundColor","borderRadius","children","textAlign","color","marginBottom","includes","length","map","item","borderBottom","paddingBottom","width","nombre","descripcion","type","value","cantidad","onChange","e","id","target","min","precio","onClick","disabled","border","cursor","marginTop"],"sources":["C:/Users/ptrej/tienda_repuestos/frontend/src/components/Carrito.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useCart } from '../context/CartContext';\r\n\r\nfunction Carrito() {\r\n  const { cart, total, removeFromCart, updateQuantity, clearCart, mensajeProducto } = useCart();\r\n\r\n  const [mensajePago, setMensajePago] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (mensajePago) {\r\n      const timer = setTimeout(() => setMensajePago(''), 5000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [mensajePago]);\r\n\r\n  const handlePagar = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await fetch('https://tiendabikes-1.onrender.com/api/productos/iniciar_pago/', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ total: total.toFixed(2) }),\r\n      });\r\n      const data = await response.json();\r\n      if (data.url && data.token) {\r\n        setMensajePago('Redirigiendo a Transbank...');\r\n        window.location.href = `${data.url}?token_ws=${data.token}`;\r\n      } else {\r\n        setMensajePago('Error: no se recibió URL ni token.');\r\n      }\r\n    } catch (error) {\r\n      setMensajePago('Error al iniciar el pago.');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        minHeight: '80vh',\r\n        padding: '20px',\r\n        maxWidth: '600px',\r\n        margin: '0 auto',\r\n        backgroundColor: '#f9f9f9',\r\n        borderRadius: '8px',\r\n      }}\r\n    >\r\n      <h1 style={{ textAlign: 'center' }}>Carrito de Compras</h1>\r\n\r\n      {mensajeProducto && (\r\n        <div style={{ color: 'green', marginBottom: '10px' }}>\r\n          {mensajeProducto}\r\n        </div>\r\n      )}\r\n\r\n      {mensajePago && (\r\n        <div style={{ color: mensajePago.includes('Error') ? 'red' : 'blue', marginBottom: '10px' }}>\r\n          {mensajePago}\r\n        </div>\r\n      )}\r\n\r\n      {cart.length === 0 ? (\r\n        <p>Tu carrito está vacío.</p>\r\n      ) : (\r\n        <>\r\n          {cart.map(item => (\r\n            <div\r\n              key={item.id}\r\n              style={{\r\n                borderBottom: '1px solid #ccc',\r\n                marginBottom: '10px',\r\n                paddingBottom: '10px',\r\n                width: '100%',\r\n              }}\r\n            >\r\n              <h3>{item.nombre}</h3>\r\n              <p>{item.descripcion}</p>\r\n              <input\r\n                type=\"number\"\r\n                value={item.cantidad}\r\n                onChange={(e) => updateQuantity(item.id, e.target.value)}\r\n                min=\"1\"\r\n              />\r\n              <p>Precio unitario: ${item.precio}</p>\r\n              <p>Subtotal: ${item.precio * item.cantidad}</p>\r\n              <button onClick={() => removeFromCart(item.id)}>Eliminar</button>\r\n            </div>\r\n          ))}\r\n          <h2>Total: ${total.toFixed(2)}</h2>\r\n          <button\r\n            onClick={handlePagar}\r\n            disabled={loading}\r\n            style={{\r\n              backgroundColor: '#0070f3',\r\n              color: 'white',\r\n              padding: '10px 20px',\r\n              border: 'none',\r\n              borderRadius: '5px',\r\n              cursor: loading ? 'not-allowed' : 'pointer',\r\n            }}\r\n          >\r\n            {loading ? 'Procesando pago...' : 'Pagar con Transbank'}\r\n          </button>\r\n          <button\r\n            onClick={clearCart}\r\n            style={{\r\n              marginTop: '10px',\r\n              backgroundColor: 'red',\r\n              color: 'white',\r\n              padding: '10px 20px',\r\n              border: 'none',\r\n              borderRadius: '5px',\r\n              cursor: 'pointer',\r\n            }}\r\n          >\r\n            Vaciar Carrito\r\n          </button>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Carrito;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}